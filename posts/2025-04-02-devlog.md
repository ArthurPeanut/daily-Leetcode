---
title: Data Collection for Paper
date: 2025-04-02
tags: [Research, Chained Vulnerabilities]
type: devlog
---
# Progress Update

## Collecting Data via Google Search

### Search API

Initially, I used the **Google Custom Search API** to collect relevant data. However, I encountered a `429 Client Error` due to exceeding the request quota.

→ I then switched to the **Serper Search API** as an alternative.

### Query Design

I crafted the following ten queries to search for information related to chained vulnerabilities:

```
    "chained vulnerability CVE",
    "vulnerability chaining CVE",
    "multi-stage exploit CVE",
    "CVE chaining technique",
    "privilege escalation chain CVE",
    "CVE exploit chain",
    "CVE dependency chain",
    "chained RCE CVE",
    "multiple CVEs exploit",
    "CVE attack path"
```

For each query, I aimed to retrieve the top 20 pages of results—roughly 200 results per query.

### Script Implementation

I developed a pipeline that:

1. Executes searches via Google (using Serper),
2. Extracts result URLs,
3. Fetches the page content,
4. Sends the content to the **GPT-4o API** to determine its relevance to our topic.

The output is a CSV file with the following columns:`"query", "link", "CVE_IDs", "is_chained", "components", "actions", "summary"`.

The script also includes a de-duplication function to avoid processing duplicate results, optimizing both time and API usage.

### Results

While we initially expected ~2000 results (10 queries × 200), de-duplication reduced this to **1385 unique entries**. Among them, **361 entries** were identified as "chained" vulnerabilities (`is_chained = Yes`), which aligns well with our initial expectations.

Here’s a sample entry:

| CVE_IDs                                                    | is_chained | Actions                                | Summary                                                                                          |
| ---------------------------------------------------------- | ---------- | -------------------------------------- | ------------------------------------------------------------------------------------------------ |
| CVE-2024-8963, CVE-2024-9379, CVE-2024-8190, CVE-2024-9380 | Yes        | RCE, 权限提升, 获取凭证, 植入 WebShell | 威胁行为者利用链式漏洞在 Ivanti 云服务应用中实现初始访问及远程代码执行，带来严重的网络安全风险。 |

## Linking Data to Neo4j

To support further analysis and visualization, I imported the processed data into **Neo4j** and ran several queries.

### Finding Most Frequently Chained Vulnerabilities

```cypher
MATCH (a:CVE)-[:CHAINED_WITH]->(b:CVE)
RETURN b.id AS cve_id, COUNT(*) AS frequency
ORDER BY frequency DESC LIMIT 10
```



And they we have:

![The most frequent vulnerabilities](/Images/2025-04-02/most_freq.png)

# Next Step

Next steps include enriching the graph with vulnerability categories and exploring temporal patterns in chaining behavior.
