---
title: Data Collection & Analysis for Paper On Chained Vulnerabilities
date: 2025-04-03
tags: [Data Collection, Data Analysis, Clustering, Chained Vulnerabilities]
type: blog
---

# 🔐 Chained Vulnerability Analysis: Data Collection and Clustering Workflow

This post summarizes the end-to-end process I've developed for analyzing chained vulnerabilities (e.g., CVE sequences used in privilege escalation or multi-stage exploits). It covers data collection, embedding, clustering, and qualitative analysis.

---

## 📥 1. Data Collection

### 🔍 Keyword Search via Google Custom Search API
- Used keywords like:
  - `chained vulnerability CVE`, `CVE chaining technique`, `privilege escalation chain`, etc.
- Automated collection with pagination (Google CSE `start` + `num` parameters).
- Collected up to 1,000 URLs from Google results.

### 🌐 Content Extraction + GPT Analysis
- For each URL:
  - Extracted main body text via BeautifulSoup.
  - Called GPT-4o API with prompt:
    > Extract CVE IDs, check if chained, list involved components, attack actions, and generate a one-sentence summary.
- Saved all structured results in `gpt_cve_results.csv`.

---

## 📊 2. Data Cleaning & Enrichment

### 📁 Merging
- Combined `gpt_cve_results.csv` with another manually collected Excel.
- De-duplicated based on `link`, while preserving full row information.

### 🔗 CVE Token Normalization
- CVE IDs stored as joined lists.
- Preserved full rows during deduplication.

---

## 🧠 3. Feature Embedding

### 🔢 Embedding Types Compared
- **MiniLM / MPNet**: Sentence embeddings from `sentence-transformers`.
- **N-gram (1~3)**: CountVectorizer with 1- to 3-gram tokens.
- **Multi-hot Tokens**: Presence of each action word as a feature.
- **TF-IDF**: Token-level tf-idf weights.
- **FastText**: Averaged pre-trained embeddings.

### 📉 Dimensionality Reduction
- All embeddings reduced to 2D using `TruncatedSVD` for visualization.

![Different embedding methods comparison](Images/2025-04-03/embedding-comparison.png)

---

## 📈 4. Clustering Attack Actions

### ✅ Approach Tried
- **KMeans (on TF-IDF)**: Initial clusters were poorly separated.
- **DBSCAN**: Found sparse clusters but with many noise points.
- **HDBSCAN**: Didn’t fit the radial structure well.
- **Angular KMeans (on theta)**: Grouped by angle (arctangent of 2D projection).
- **Directional KMeans (unit vector clustering)**: ✅ Best performance: each radial "ray" became a distinct cluster.

![The best performance: directional kmeans](Images/2025-04-03/tf-idf-directional-kmeans.png)

---

## 🔬 5. Qualitative Analysis

### 📌 Per-Cluster Breakdown
- Extracted top-10 `action` tokens for each cluster.
- Identified themes like:
  - Remote Code Execution + Privilege Escalation
  - Injection + Access Bypass
  - Tool-based Exploitation Chains (e.g. PoCs)

### 📍 Representative Samples
- Selected 3 nearest points to cluster center in TF-IDF space.
- Exported full CVE ID list, actions, summary, and source link.

### 🧠 GPT Summaries
- Prompted GPT-4o to summarize patterns within each cluster:
  - e.g., "A typical attack chain that escalates from web entry to full system control via chained exploits."

---

## 🔗 Graph Import (Neo4j)
- Imported CVEs and their relationships into Neo4j.
- Each CVE as a node, chained CVEs connected with `CHAINED_WITH`.
- Enabled downstream graph analysis (paths, components, frequency).

---

## ✅ Next Steps
- Expand keywords + web sources (e.g., GitHub issues, vendor advisories).
- Introduce temporal information (disclosure timeline).
- Explore GNNs for classifying unknown chains.

---

Stay tuned for more updates and deeper structural modeling!

